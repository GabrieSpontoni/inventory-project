{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","app/components/actions/return-photos/Photos.js","app/actions/ReturnPhotos.js"],"names":["_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iterableToArray","unsupportedIterableToArray","TypeError","_iterableToArray","iter","Symbol","iterator","Object","from","Photos","idAction","useParams","useForm","register","handleSubmit","useState","photosName","setPhotosName","photosUrl","setPhotosUrl","user","setUser","isLoading","setIsLoading","show","setShow","useEffect","isMounted","dbRef","firebase","database","ref","auth","onAuthStateChanged","child","uid","get","then","snapshot","exists","val","console","log","catch","error","storage","pathReference","id_filial","listAll","res","items","length","photosList","forEach","folderRef","i","push","name","getDownloadURL","url","handleClose","className","keys","map","e","key","style","height","width","marginRight","marginTop","display","src","alt","borderRadius","type","marginBottom","marginLeft","onClick","Modal","onHide","Body","Alert","variant","Heading","Footer","Button","photoName","delete","window","location","reload","onSubmit","data","storageRef","files","put","toast","success","theme","position","cursor","background","border","id","accept","multiple","required","ReturnPhotos","Component"],"mappings":"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","file":"static/js/14.ed42fe9d.chunk.js","sourcesContent":["import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { ToastContainer, toast } from \"react-toastify\";\nimport { Modal, Button, Alert } from \"react-bootstrap\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport firebase from \"firebase/app\";\n\nimport \"./Photos.css\";\n\nexport function Photos() {\n  const { idAction } = useParams();\n  const { register, handleSubmit } = useForm();\n  const [photosName, setPhotosName] = useState([]);\n  const [photosUrl, setPhotosUrl] = useState([]);\n  const [user, setUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [show, setShow] = useState(false);\n\n  useEffect(() => {\n    let isMounted = true;\n    const dbRef = firebase.database().ref();\n    firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        dbRef\n          .child(`usuarios/${user.uid}`)\n          .get()\n          .then((snapshot) => {\n            if (isMounted) {\n              if (snapshot.exists()) {\n                setUser({ ...snapshot.val() });\n                // console.log(snapshot.val());\n              } else {\n                console.log(\"No data available\");\n                setUser({});\n              }\n            }\n          })\n          .catch((error) => {\n            console.error(error);\n          });\n      } else {\n        console.log(\"no user\");\n      }\n    });\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    let isMounted = true;\n    var storage = firebase.storage();\n    if (user) {\n      var pathReference = storage.ref(\n        `/filiais/${user.id_filial}/acoes/${idAction}/`\n      );\n      console.log();\n      pathReference\n        .listAll()\n        .then(function (res) {\n          if (res.items.length === 0) {\n            setIsLoading(false);\n          }\n          if (isMounted) {\n            const photosList = [];\n            res.items.forEach(function (folderRef, i) {\n              photosList.push(res.items[i].name);\n              folderRef.getDownloadURL().then(function (url) {\n                setPhotosUrl((arr) => [...arr, url]);\n              });\n            });\n            setPhotosName(photosList);\n          }\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    }\n    return () => {\n      isMounted = false;\n    };\n  }, [idAction, user]);\n\n  const onSubmit = (data) => {\n    console.log(data);\n    const storageRef = firebase.storage().ref();\n\n    for (let i = 0; i < data.files.length; i++) {\n      storageRef\n        .child(\n          `filiais/${user.id_filial}/produtos/${idAction}/${data.files[i].name}`\n        )\n        .put(data.files[i])\n        .then(function (snapshot) {\n          toast.success(`${data.files[i].name} upload OK`, {\n            theme: \"dark\",\n            position: \"top-center\",\n          });\n        })\n        .catch(() => {\n          console.log(\"upload fail\");\n        });\n    }\n  };\n\n  const handleDelete = (photoName) => {\n    const storageRef = firebase.storage().ref();\n    storageRef\n      .child(`filiais/${user.id_filial}/produtos/${idAction}/${photoName}`)\n      .delete()\n      .then(function () {\n        console.log(\"delete ok\");\n        window.location.reload();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  const handleClose = () => setShow(false);\n  const handleShow = (id) => {\n    setShow(true);\n  };\n\n  return (\n    <div>\n      {photosUrl.length === 0 && isLoading && <div>Carregando...</div>}\n      {photosUrl.length === 0 && !isLoading && (\n        <div>Este produto não possui fotos</div>\n      )}\n      <div className=\"row\">\n        {photosUrl.length > 0 &&\n          Object.keys(photosUrl).map((e) => {\n            return (\n              <div key={e}>\n                <div\n                  className=\"card\"\n                  style={{\n                    height: \"400px\",\n                    width: \"300px\",\n                    marginRight: \"50px\",\n                    marginTop: \"50px\",\n                    display: \"flex\",\n                  }}\n                >\n                  <div className=\"card-body\">\n                    <img\n                      src={photosUrl[e]}\n                      alt=\"\"\n                      style={{\n                        width: \"100%\",\n                        height: \"100%\",\n                        borderRadius: \"8px\",\n                      }}\n                    />\n                  </div>\n\n                  <div\n                    className=\"card-footer\"\n                    style={{ display: \"inline-block\" }}\n                  >\n                    {photosName[e]}\n\n                    <div>\n                      <button\n                        type=\"button\"\n                        className=\"btn btn-danger btn-icon-text\"\n                        style={{\n                          marginBottom: \"10px\",\n                          marginLeft: \"60%\",\n                        }}\n                        onClick={() => {\n                          handleShow();\n                        }}\n                      >\n                        <i className=\"mdi mdi-delete btn-icon-prepend\" />\n                        Excluir\n                      </button>\n                      <Modal show={show} onHide={handleClose}>\n                        <Modal.Body>\n                          <Alert variant=\"danger\">\n                            <Alert.Heading>TEM CERTEZA?</Alert.Heading>\n                            <p>\n                              Ao excluir a foto deste produto a operação não\n                              poderá ser desfeita.\n                            </p>\n                            <hr />\n                          </Alert>\n                        </Modal.Body>\n                        <Modal.Footer>\n                          <Button variant=\"danger\" onClick={handleClose}>\n                            Cancelar\n                          </Button>\n                          <Button\n                            variant=\"success\"\n                            onClick={() => {\n                              handleDelete(photosName[e]);\n                            }}\n                          >\n                            Confirmar\n                          </Button>\n                        </Modal.Footer>\n                      </Modal>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n\n        <div\n          className=\"card\"\n          style={{\n            height: \"400px\",\n            width: \"300px\",\n            marginRight: \"50px\",\n            marginTop: \"50px\",\n            display: \"flex\",\n          }}\n        >\n          <div className=\"card-body\">\n            <div>\n              <form className=\"form-sample\" onSubmit={handleSubmit(onSubmit)}>\n                <label>\n                  <i\n                    className=\"icon-lg mdi mdi-image-multiple text-primary\"\n                    style={{\n                      marginLeft: \"90px\",\n                      marginTop: \"90px\",\n                      display: \"flex\",\n                      cursor: \"pointer\",\n                    }}\n                  />\n                  <input\n                    style={{\n                      cursor: \"pointer\",\n                      background: \"transparent\",\n                      border: \"none\",\n                    }}\n                    id=\"myInput\"\n                    type=\"file\"\n                    accept=\"image/*\"\n                    multiple\n                    className=\"form-control\"\n                    required\n                    {...register(\"files\")}\n                  />\n                </label>\n                <div>\n                  <button\n                    type=\"submit\"\n                    className=\"btn btn-primary btn-icon-text\"\n                    style={{ width: \"100%\", marginTop: \"100px\" }}\n                  >\n                    Adicionar Fotos(s)\n                  </button>\n                  <ToastContainer />\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport \"../../firebase/config\";\nimport { Photos } from \"../components/actions/return-photos/Photos\";\n\nexport class ReturnPhotos extends Component {\n  render() {\n    return (\n      <div>\n        <Photos />\n      </div>\n    );\n  }\n}\n\nexport default ReturnPhotos;\n"],"sourceRoot":""}